\definecolor{hidden-draw}{RGB}{128, 128, 128}

\tikzstyle{my-box}=[
    rectangle,
    draw=hidden-draw,
    rounded corners,
    align=left,
    text opacity=1,
    minimum height=1.5em,
    minimum width=5em,
    inner sep=2pt,
    fill opacity=.8,
    line width=0.8pt,
]

\tikzstyle{leaf-head}=[my-box, minimum height=1.5em,
    draw=gray!80, 
    fill=gray!35,  
    text=black, font=\normalsize,
    inner xsep=2pt,
    inner ysep=4pt,
    line width=0.8pt,
]

\tikzstyle{leaf-task}=[my-box, minimum height=2.5em,
    draw=red!80, 
    fill=red!20,  
    text=black, font=\normalsize,
    inner xsep=2pt,
    inner ysep=4pt,
    line width=0.8pt,
]

\tikzstyle{leaf-paradigms}=[my-box, minimum height=2.5em,
    draw=orange!70, 
    fill=orange!15,  
    text=black, font=\normalsize,
    inner xsep=2pt,
    inner ysep=4pt,
    line width=0.8pt,
]
\tikzstyle{leaf-others}=[my-box, minimum height=2.5em,
    %fill=hidden-pink!80,
    draw=yellow!80, 
    fill=yellow!15,  
    text=black, font=\normalsize,
    inner xsep=2pt,
    inner ysep=4pt,
    line width=0.8pt,
]
\tikzstyle{leaf-other}=[my-box, minimum height=2.5em,
    %fill=hidden-pink!80,
    draw=green!80, 
    fill=green!15,  
    text=black, font=\normalsize,
    inner xsep=2pt,
    inner ysep=4pt,
    line width=0.8pt,
]
\tikzstyle{leaf-application}=[my-box, minimum height=2.5em,
    %fill=hidden-pink!80,
    draw=blue!80, 
    fill=blue!15,  
    text=black, font=\normalsize,
    inner xsep=2pt,
    inner ysep=4pt,
    line width=0.8pt,
]

\tikzstyle{modelnode-task}=[my-box, minimum height=1.5em,
    draw=red!80, 
    fill=red!20,  
    text=black, font=\normalsize,
    inner xsep=2pt,
    inner ysep=4pt,
    line width=0.8pt,
]

\tikzstyle{modelnode-paradigms}=[my-box, minimum height=1.5em,
    draw=orange!70, 
    fill=orange!15,  
    text=black, font=\normalsize,
    inner xsep=2pt,
    inner ysep=4pt,
    line width=0.8pt,
]
\tikzstyle{modelnode-others}=[my-box, minimum height=1.5em,
    draw=yellow!80, 
    fill=yellow!15,  
    text=black, font=\normalsize,
    inner xsep=2pt,
    inner ysep=4pt,
    line width=0.8pt,
]
\tikzstyle{modelnode-other}=[my-box, minimum height=1.5em,
    draw=green!80, 
    fill=green!15,  
    text=black, font=\normalsize,
    inner xsep=2pt,
    inner ysep=4pt,
    line width=0.8pt,
]
\tikzstyle{modelnode-application}=[my-box, minimum height=1.5em,
    draw=blue!80, 
    fill=blue!15,  
    text=black, font=\normalsize,
    inner xsep=2pt,
    inner ysep=4pt,
    line width=0.8pt,
]

\begin{figure*}[!th]
    \centering
    \resizebox{1\textwidth}{!}
    {
        \begin{forest}
            % forked edges,
            for tree={
                grow=east,
                reversed=true,
                anchor=base west,
                parent anchor=east,
                child anchor=west,
                base=left,
                font=\normalsize,
                rectangle,
                draw=hidden-draw,
                rounded corners,
                align=left,
                minimum width=1em,
                edge+={darkgray, line width=1pt},
                s sep=10pt,
                inner xsep=0pt,
                inner ysep=3pt,
                line width=0.8pt,
                ver/.style={rotate=90, child anchor=north, parent anchor=south, anchor=center},
            }, 
            % where level=1{text width=2em,font=\small,}{},
            % where level=2{text width=2em,font=\small,}{},
            % where level=3{text width=2em,font=\small,}{},
            [% 中括号之间不要换行！！！
                \textbf{Special Attention Heads},leaf-head, ver   
                [
                    \S \ref{subsec:KR} Knowledge Recalling, leaf-paradigms, text width=12em
                    [
                        \ General Tasks, leaf-paradigms, text width=9em
                        [\textbf{Associative Memories Head}~\citep{AssociativeMemory_23_NIPS_Meta}{, }\textbf{Memoey Head}~\citep{KnowledgeConflict_24_arXiv_UCAS},  modelnode-paradigms, text width=44em]
                    ]
                    [
                       \ Specific Tasks, leaf-paradigms, text width=9em
                         [\textbf{Constant Head}{ (MCQA)}~\citep{CorrectLetterHead_23_arXiv_DeepMind}{, }\textbf{Single Letter Head}{ (MCQA)}~\citep{CorrectLetterHead_23_arXiv_DeepMind}{, }\\\textbf{Negative Head}{ (BDT)}~\citep{NegativeHead_24_arXiv_SNU},                          modelnode-paradigms, text width=44em]
                    ]
                ]
                [
                    \S \ref{subsec:ICI} In-Context Identification, leaf-others,text width=12.5em
                    [
                        \ Overall Structure, leaf-others, text width=9em
                        [\textbf{Previous Head}~\citep{InductionHeads_22_TCT_Anthropic}{, }\textbf{Positional Head}~\citep{InformationFlow_24_arXiv_Meta,SpecialHead_19_ACL_Russia}{, }\\\textbf{Rare Words Head}~\citep{SpecialHead_19_ACL_Russia}{, } \textbf{Duplicate Token Head}~\citep{IOI_23_ICLR_Redwood}{, } \textbf{Retrieval head}\\~\citep{RetrievalHead_24_arXiv_PKU}{, }\textbf{Global Retrieval head}~\citep{RetrievalHead_24_arXiv_Huawei}, modelnode-others, text width=43.5em]
                    ]
                    [
                         \ Syntactic Information, leaf-others, text width=9.5em
                         [\textbf{Subword Merge Head}~\citep{InformationFlow_24_arXiv_Meta}{, }\textbf{Syntactic Head}~\citep{SpecialHead_19_ACL_Russia}{, }\textbf{Mover Head}\\~\citep{KnowledgeCircuit_24_arXiv_ZJU}{, }\textbf{Name Mover Head}{ \& }\textbf{Backup Name Mover Head}~\citep{CopySupression_23_arXiv_Google}{, }\\\textbf{Letter Mover Head}~\citep{AcronymPredict_24_arXiv_Alicante}{, }\textbf{Negative Name Mover Head}~\citep{IOI_23_ICLR_Redwood}, modelnode-others, text width=43em]
                    ]
                    [
                        \ Semantic Information, leaf-others, text width=9.5em
                        [\textbf{Context Head}~\citep{KnowledgeConflict_24_arXiv_UCAS}{, }\textbf{Content Gatherer Head}~\citep{CorrectLetterHead_23_arXiv_DeepMind,ColorObject_24_ICLR_BrownU}{, }\\\textbf{Sentiment Summarizer}~\citep{Sentiment_23_arXiv_EleutherAI}{, }\textbf{Semantic Induction Head}~\citep{Semantic_24_arXiv_SJTU}{, }\\\textbf{Subject Head}{ \& }\textbf{Relation Head}~\citep{FactualRecall_24_arXiv_Independent}, modelnode-others,text width=43em]
                    ]
                ]
                [
                    \S \ref{subsec:LR} Latent Reasoning, leaf-other,text width=12em
                    [
                        \ In-context Learning, leaf-other, text width=10em
                        [
                            \textbf{Summary Reader}~\citep{Sentiment_23_arXiv_EleutherAI}{, }\textbf{Function Vector}~\citep{FunctionVector_24_ICLR_NEU}{, }\textbf{Induction Head}\\\citep{InductionHeads_22_TCT_Anthropic,Markov_24_arXiv_Harvard,FSL_24_ICML_UCL,HumanMemory_24_arXiv_UCSD,InductionHead_24_arXiv_UoA}, modelnode-other, text width=43em
                        ]
                    ]
                    [
                        \ Effective Reasoning, leaf-other, text width=10em
                        [
                            \textbf{Truthfulness Head}~\citep{ITI_23_NIPS_harvard,NL-ITI_24_arXiv-Samsung}{, }\textbf{Accuracy Head}~\citep{CrossLingual_24_SIGIR_UCAS}{, }\\\textbf{Vulnerable Head}~\citep{VulnerableHead_24_arXiv_Alicante}, modelnode-other, text width=43em
                        ]
                    ]
                    [
                        \ Task-Specific, leaf-other, text width=9.5em
                        [
                            \textbf{Correct Letter Head}~\citep{CorrectLetterHead_23_arXiv_DeepMind}{, }\textbf{Iteration Head}~\citep{IterationHead_24_arXiv_Meta}{, }\textbf{Successor Head}\\\citep{SuccessorHead_24_ICLR_Cambridge}{, }\textbf{S-Inhibition Head}\citep{IOI_23_ICLR_Redwood}, modelnode-other, text width=43.5em
                        ]
                    ]
                ]
                [
                    \S \ref{subsec:LR} Expression Preparation, leaf-application,text width=12em
                    [
                        \ Information Aggregation, leaf-application, text width=10.7em
                        [
                            \textbf{Mixed Head}~\citep{FactualRecall_24_arXiv_Independent}, modelnode-application, text width=42.3em
                        ]
                    ]
                    [
                        \ Signal Amplification, leaf-application, text width=10.7em
                        [
                            \textbf{Amplification Head}~\citep{CorrectLetterHead_23_arXiv_DeepMind}{, }\textbf{Correct Head}~\citep{CorrectHead_24_arXiv_Allen}, modelnode-application, text width=42.3em
                        ]
                    ]
                    [
                        \ Instruction Alignment, leaf-application, text width=10.7em
                        [
                            \textbf{Coherence Head}~\citep{CrossLingual_24_SIGIR_UCAS}{, }\textbf{Faithfulness Head}~\citep{FaithfulCoT_24_ICML_Harvard}, modelnode-application, text width=42.3em
                        ]
                    ]
                ]
            ]
        \end{forest}
    }
    \caption{Taxonomy of special attention heads in language models.}
    \label{fig:head_taxnomomy}
\vspace{-0.3cm}
\end{figure*}

% \textbf{Amplification Head}~\citep{CorrectLetterHead_23_arXiv_DeepMind}{, }\textbf{Correct Head}~\citep{CorrectHead_24_arXiv_Allen}{, }\textbf{Coherence Head}~\citep{CrossLingual_24_SIGIR_UCAS}{, }\textbf{Faithfulness Head}~\citep{FaithfulCoT_24_ICML_Harvard}
% modelnode-application